!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common"),require("ionic-angular/index"),require("@angular/forms"),require("moment")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/common","ionic-angular/index","@angular/forms","moment"],t):t((e.i2e=e.i2e||{},e.i2e.calendar=e.i2e.calendar||{}),e.ng.core,e.ng.common,e.ing,e.ng.forms,e.moment)}(this,function(e,t,i,n,a,o){"use strict";var r=o.default,s=r||o,d={provide:a.NG_VALUE_ACCESSOR,useExisting:t.forwardRef(function(){return f}),multi:!0},l=["","monday","tuesday","wednesday","thursday","friday","saturday","sunday"],h=function(){function e(){}return e}(),c=function(){function e(){}return e}(),u=function(){function e(e){this.disabled=!1,this.highlight=!1;var t=Object.keys(e);this.type=e.type,this.date=e.date,this.selected=e.selected,t.indexOf("disabled")>-1&&(this.disabled=e.disabled),t.indexOf("highlight")>-1&&(this.highlight=e.highlight)}return e.prototype.toString=function(){return"day"===this.type?""+this.date.getDate():"month"===this.type?s(this.date).format("MMM"):""+this.date.getFullYear()},e.prototype.getRange=function(){if("day"===this.type){var e=s(this.date);return{start:e,end:e}}var t=s(this.date);return{start:t.clone().startOf(this.type),end:t.clone().endOf(this.type)}},e}(),f=function(){function e(e){this._form=e,this.ionChange=new t.EventEmitter,this._disabled=!1,this._dateOnlyForDay=!1,this._viewMode="month",this._selectionMode="day",this._startOfWeekDay=1,this._change=new t.EventEmitter,this._viewDate=new Date,this._viewMoment=s(),this._viewHeader="",this._calendarRows=[],this._weekDays=[],this._onChangeCallback=function(e){},this._onTouchedCallback=function(){},e.register(this)}return Object.defineProperty(e.prototype,"viewDate",{get:function(){return this._viewDate},set:function(e){this._setViewDate(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled=null!=e&&""+e!="false"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dateOnlyForDay",{get:function(){return this._disabled},set:function(e){this._dateOnlyForDay=null!=e&&""+e!="false"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewMode",{get:function(){return this._viewMode},set:function(e){this._viewMode=e,this._buildCalendar()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionMode",{get:function(){return this._selectionMode},set:function(e){this._selectionMode=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startOfWeekDay",{get:function(){return l[this._startOfWeekDay]},set:function(e){this._startOfWeekDay=l.indexOf(e),o.updateLocale(o.locale(),{week:{dow:this._startOfWeekDay}}),"month"===this._viewMode&&this._buildCalendar()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minDate",{get:function(){return this._minDate},set:function(e){this._minDate=null!=e?new Date(e.valueOf()):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxDate",{get:function(){return this._maxDate},set:function(e){this._maxDate=null!=e?new Date(e.valueOf()):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"change",{get:function(){return this._change.asObservable()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedPeriod",{set:function(e){this._selectedPeriod=e,this._change.emit({source:this,period:e}),this._refreshSelection()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._dateOnlyForDay&&"day"===this.selectionMode?null!=this._selectedPeriod?this._selectedPeriod.startDate:null:this._selectedPeriod},set:function(e){this._dateOnlyForDay&&"day"===this.selectionMode?e instanceof Date&&(null==this._selectedPeriod||e!==this._selectedPeriod.startDate)&&(this.selectedPeriod={type:"day",startDate:e,endDate:e},this._init&&this.ionChange.emit(this),this._onChangeCallback(e)):e instanceof Object&&e!==this._selectedPeriod&&(this.selectedPeriod=e,this._init&&this.ionChange.emit(this),this._onChangeCallback(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"calendarRows",{get:function(){return this._calendarRows},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"viewHeader",{get:function(){return this._viewHeader},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weekDays",{get:function(){return this._weekDays},enumerable:!0,configurable:!0}),e.prototype.prevPage=function(){"month"===this._viewMode?this.viewDate=s(this.viewDate).subtract(1,"M").toDate():"year"===this._viewMode&&(this.viewDate=s(this.viewDate).subtract(1,"y").toDate()),this._buildCalendar()},e.prototype.nextPage=function(){"month"===this._viewMode?this.viewDate=s(this.viewDate).add(1,"M").toDate():"year"===this._viewMode&&(this.viewDate=s(this.viewDate).add(1,"y").toDate()),this._buildCalendar()},e.prototype.previousViewMode=function(){"decade"!==this._viewMode&&("year"===this._viewMode?this._viewMode="decade":"month"===this._viewMode&&(this._viewMode="year"),this._buildCalendar())},e.prototype.selectEntry=function(e){if(!this._canSelectEntry(e))return this._nextViewMode(e);var t;"full"===this._isEntrySelected(e)?t=null:"day"===this._selectionMode?t=this._dateOnlyForDay?e.date:{type:"day",startDate:e.date,endDate:e.date}:"week"===this._selectionMode?t={type:"week",startDate:new Date(s(e.date).startOf("week").toDate().valueOf()),endDate:new Date(s(e.date).endOf("week").toDate().valueOf())}:"month"===this._selectionMode?t={type:"month",startDate:new Date(s(e.date).startOf("month").toDate().valueOf()),endDate:new Date(s(e.date).endOf("month").toDate().valueOf())}:"year"===this._selectionMode&&(t={type:"year",startDate:new Date(s(e.date).startOf("year").toDate().valueOf()),endDate:new Date(s(e.date).endOf("year").toDate().valueOf())}),this.value=t},e.prototype.registerOnChange=function(e){this._onChangeCallback=e},e.prototype.registerOnTouched=function(e){this._onTouchedCallback=e},e.prototype.writeValue=function(e){"string"==typeof e&&(e=s(e).toDate()),this.value=e},e.prototype.ngOnInit=function(){this._buildCalendar()},e.prototype.ngAfterContentInit=function(){this._init=!0,this._refreshSelection()},e.prototype.ngOnDestroy=function(){this._form.deregister(this)},e.prototype._getMonthName=function(e){return s(e).format("MMM")},e.prototype._setViewDate=function(e){this._viewDate=e,this._viewMoment=s(e)},e.prototype._buildCalendar=function(){"month"===this._viewMode?this._buildMonthView():"year"===this._viewMode?this._buildYearView():"decade"===this._viewMode&&this._buildDecadeView()},e.prototype._buildDecadeView=function(){var e=this._viewDate.getFullYear(),t=e-e%10+1,i=t+11;this._viewHeader=t+" - "+i;for(var n=s(this.viewDate).startOf("year").year(t),a=[],o=0;o<4;o++){for(var r=[],d=0;d<3;d++){var l=new Date(n.toDate().valueOf()),h=new u({type:"year",date:l,selected:"none"});h.selected=this._isEntrySelected(h),r.push(h),n.add(1,"y")}a.push(r)}this._calendarRows=a},e.prototype._buildYearView=function(){this._viewHeader=""+this._viewDate.getFullYear();for(var e=s(this.viewDate).startOf("year"),t=[],i=0;i<4;i++){for(var n=[],a=0;a<3;a++){var o=new Date(e.toDate().valueOf()),r=new u({type:"month",date:o,selected:"none"});r.selected=this._isEntrySelected(r),n.push(r),e.add(1,"M")}t.push(n)}this._calendarRows=t},e.prototype._buildMonthView=function(){this._viewHeader=s(this._viewDate).format("MMM YYYY"),this._buildMonthViewWeekDays();for(var e=s(this.viewDate).startOf("month").startOf("week"),t=s(this.viewDate).endOf("month").endOf("week"),i=[],n=s(),a=s(e),o=null==this.minDate?null:s(this.minDate),r=null==this.maxDate?null:s(this.maxDate);a<t;){for(var d=[],l=0;l<7;l++){var h=null!=o&&a.isBefore(o)||null!=r&&a.isAfter(r),c=new Date(a.toDate().valueOf()),f=new u({type:"day",date:c,selected:"none",highlight:n.format("YYYY-MM-DD")===a.format("YYYY-MM-DD"),disabled:h});f.selected=this._isEntrySelected(f),d.push(f),a.add(1,"d")}i.push(d)}this._calendarRows=i},e.prototype._buildMonthViewWeekDays=function(){for(var e=s().startOf("week"),t=[],i=0;i<7;i++)t.push(e.format("ddd")),e.add(1,"d");this._weekDays=t},e.prototype._periodOrder=function(e){return["day","week","month","year"].indexOf(e)},e.prototype._isEntrySelected=function(e){if(null!=this._selectedPeriod&&null!=this._selectedPeriod.type&&null!=this._selectedPeriod.startDate&&null!=this._selectedPeriod.endDate){var t=s(this._selectedPeriod.startDate).startOf("day"),i=s(this._selectedPeriod.endDate).endOf("day"),n=this._periodOrder(this._selectedPeriod.type),a=this._periodOrder(e.type),o=e.getRange();if(a<=n&&o.start.isBetween(t,i,null,"[]")&&o.end.isBetween(t,i,null,"[]"))return"full";if(a>n&&t.isBetween(o.start,o.end,null,"[]")&&i.isBetween(o.start,o.end,null,"[]"))return"partial"}return"none"},e.prototype._refreshSelection=function(){for(var e=0,t=this._calendarRows;e<t.length;e++)for(var i=t[e],n=0,a=i;n<a.length;n++){var o=a[n];o.selected=this._isEntrySelected(o)}},e.prototype._canSelectEntry=function(e){return!(["day","week"].indexOf(this._selectionMode)>=0&&"day"!==e.type)&&("month"!==this._selectionMode||"year"!==e.type)},e.prototype._nextViewMode=function(e){if("decade"===this._viewMode)this._viewMode="year";else if("year"===this._viewMode)this._viewMode="month";else if("month"===this._viewMode)return;this._viewDate=e.date,this._buildCalendar()},e}();f.decorators=[{type:t.Component,args:[{selector:"ion-calendar",template:'<div class="ion-calendar-header"> <button ion-fab left [disabled]="disabled" (click)="prevPage()">&#8592;</button> <button ion-button [disabled]="disabled" (click)="previousViewMode()" light class="ion-calendar-header-title"> {{ viewHeader }} </button> <button ion-fab right [disabled]="disabled" (click)="nextPage()">&#8594;</button> </div> <div class="ion-calendar-row" *ngIf="viewMode == \'month\'"> <div *ngFor="let weekDay of weekDays"> <div class="button-label">{{ weekDay }}</div> </div> </div> <div class="ion-calendar-row" *ngFor="let row of calendarRows"> <button ion-button [color]="entry.selected == \'none\' ? \'light\' : \'danger\'" [disabled]="disabled || entry.disabled" [class.ion-calendar-partial-selection]="entry.selected == \'partial\'" [class.ion-calendar-highlight]="entry.selected === \'none\' && entry.highlight" (click)="selectEntry(entry)" *ngFor="let entry of row"> {{ entry.toString() }} </button> </div> ',styles:[":host{display:flex;box-sizing:border-box;width:100%;height:320px;flex-direction:column}:host .ion-calendar-header,:host .ion-calendar-row{display:flex;box-sizing:border-box;width:100%;flex-direction:row}:host .ion-calendar-header{height:40px}:host .ion-calendar-header button[ion-fab]{width:40px;height:40px;margin:0;position:relative;left:0;right:0}:host .ion-calendar-header .ion-calendar-header-title{flex:1;margin:0 10px}:host .ion-calendar-row{flex:1}:host .ion-calendar-row button,:host .ion-calendar-row div{flex:1;margin:3px;height:auto}:host .ion-calendar-row div{line-height:40px;text-align:center}:host .ion-calendar-row .ion-calendar-partial-selection ::before{content:'';position:absolute;top:0;right:0;bottom:0;left:0;background-color:rgba(255,255,255,.5)}:host .ion-calendar-row .ion-calendar-highlight{background-color:#fcd739} /*# sourceMappingURL=calendar.css.map */ "],providers:[d]}]}],f.ctorParameters=function(){return[{type:n.Form}]},f.propDecorators={ionChange:[{type:t.Output}],viewDate:[{type:t.Input,args:["view-date"]}],disabled:[{type:t.Input}],dateOnlyForDay:[{type:t.Input}],viewMode:[{type:t.Input,args:["view-mode"]}],selectionMode:[{type:t.Input,args:["selection-mode"]}],startOfWeekDay:[{type:t.Input,args:["start-of-week-day"]}],minDate:[{type:t.Input}],maxDate:[{type:t.Input}],change:[{type:t.Output}]};var p=[f],y=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[]}},e}();y.decorators=[{type:t.NgModule,args:[{imports:[i.CommonModule,n.IonicModule],exports:[f],declarations:[f],entryComponents:[f],providers:[]}]}],y.ctorParameters=function(){return[]},e.ION_CALENDAR_CONTROL_VALUE_ACCESSOR=d,e.IonCalendarPeriod=h,e.IonCalendarChange=c,e.IonCalendarEntry=u,e.IonCalendar=f,e.ION_CALENDAR_DIRECTIVES=p,e.IonCalendarModule=y,Object.defineProperty(e,"__esModule",{value:!0})});